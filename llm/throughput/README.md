# MosaicGPT Throughput, MFU, and HFU
Throughput, MFU, and HFU for different sized MosaicGPT models trained on MCloud.
MFU and HFU are defined in https://arxiv.org/abs/2205.05198
All FLOP calculations do not include norm, act, and residual.

MFU approximation:
Using only the parameters, per token, each parameter is used for a MAC (2 FLOPS) per network operation. Neural Network training has 4 network operations: forward pass, backward pass, and computation of parameter gradient.
The attention mechanism forward pass FLOPS are: `attn_flops_per_seq = n_layers * 2 * 2 * (d_model * (seq_len**2))`
```
flops_per_token = 2 * n_params
flops_per_seq = flops_per_token * seq_len
mfu* = 3 * flops_per_seq * throughput / (gpu_num * GPU_AVAILABLE_FLOPS)

attn_flops_per_seq = n_layers * 2 * 2 * (d_model * (seq_len**2))
mfu = (3 * flops_per_seq + 3 * attn_flops_per_seq) * throughput / (gpu_num * GPU_AVAILABLE_FLOPS)
```

HFU is approximated using the fact that the networks use checkpointing for activation recomputation. This effectively requires an extra forward pass through the network.
```
hfu* = 4 * flops_per_seq * throughput / (gpu_num * GPU_AVAILABLE_FLOPS)
hfu = (4 * flops_per_seq + 4 * attn_flops_per_seq) * throughput / (gpu_num * GPU_AVAILABLE_FLOPS)
```

These are approximations. Real HFU would be higher since it would include the FLOP usage of norm, act, residual, as well as account for ALL recomputation (the model uses FlashAttn which already does a recomputation in the fwd pass; in reality, the hfu attn multiplier should be 5 instaed of 3).

Below we highlight some of the configurations, but the full tables can be found in [FULL_TABLES](./FULL_TABLES.md)

## A100 80GB

| Model   | SeqLen (T) | GPUType       | MFU*   | MFU    | HFU*   | HFU    | Throughput (T/s) | GPUThroughput (T/s/GPU) | Throughput (S/s) | ParamCount  | GlobalBatchSize (T) | GlobalBatchSize (S) | MicroBatchSize (S) | GradAccum | ShardStrategy | ActCkpt | ActCPUoffload | Precision | MP Mode | NumGPUs | GPUType   |
| ------- | ---------- | ------------- | ------ | ------ | ------ | ------ | ---------------- | ----------------------- | ---------------- | ----------- | ------------------- | ------------------- | ------------------ | --------- | ------------- | ------- | ------------- | --------- | ------- | ------- | --------- |
|  gpt70b |       2048 | 128xA100_80GB | 0.4096 | 0.4265 | 0.5461 | 0.5687 |         42028.81 |                328.3501 |          20.5219 | 64861528064 |             2097152 |                1024 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |     128 | a100_80gb |
|  gpt30b |       8192 |  64xA100_80GB | 0.3790 | 0.4502 | 0.5054 | 0.6003 |         42023.16 |                656.6118 |           5.1298 | 30018458624 |             1048576 |                 128 |                  2 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      64 | a100_80gb |
|  gpt30b |       8192 |  32xA100_80GB | 0.3734 | 0.4435 | 0.4979 | 0.5914 |         20698.23 |                646.8198 |           2.5266 | 30018458624 |              524288 |                  64 |                  2 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      32 | a100_80gb |
|  gpt30b |       8192 |  16xA100_80GB | 0.3823 | 0.4541 | 0.5097 | 0.6054 |         10595.78 |                662.2362 |           1.2934 | 30018458624 |              262144 |                  32 |                  2 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_80gb |
|  gpt30b |       4096 | 128xA100_80GB | 0.4249 | 0.4649 | 0.5666 | 0.6198 |         94312.24 |                736.8144 |          23.0254 | 29989098496 |             2097152 |                 512 |                  4 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |     128 | a100_80gb |
|  gpt30b |       4096 |  32xA100_80GB | 0.4245 | 0.4644 | 0.5660 | 0.6192 |         23553.76 |                736.0550 |           5.7504 | 29989098496 |              524288 |                 128 |                  4 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      32 | a100_80gb |
|  gpt30b |       4096 |  16xA100_80GB | 0.4253 | 0.4653 | 0.5671 | 0.6204 |         11799.06 |                737.4413 |           2.8806 | 29989098496 |              262144 |                  64 |                  4 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_80gb |
|  gpt30b |       2048 | 256xA100_80GB | 0.4464 | 0.4674 | 0.5952 | 0.6232 |        198267.62 |                774.4829 |          96.8104 | 29974418432 |             4194304 |                2048 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |     256 | a100_80gb |
|  gpt30b |       2048 | 128xA100_80GB | 0.4548 | 0.4762 | 0.6064 | 0.6349 |        100995.65 |                789.0285 |          49.3143 | 29974418432 |             2097152 |                1024 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |     128 | a100_80gb |
|  gpt30b |       2048 |  64xA100_80GB | 0.4562 | 0.4777 | 0.6083 | 0.6369 |         50651.59 |                791.4310 |          24.7322 | 29974418432 |             1048576 |                 512 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      64 | a100_80gb |
|  gpt30b |       2048 |  32xA100_80GB | 0.4580 | 0.4796 | 0.6107 | 0.6394 |         25427.85 |                794.6202 |          12.4159 | 29974418432 |              524288 |                 256 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      32 | a100_80gb |
|  gpt30b |       2048 |  16xA100_80GB | 0.4562 | 0.4777 | 0.6083 | 0.6369 |         12663.75 |                791.4842 |           6.1835 | 29974418432 |              262144 |                 128 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_80gb |
|  gpt13b |       8192 | 128xA100_80GB | 0.3316 | 0.4180 | 0.4421 | 0.5573 |        171301.11 |               1338.2899 |          20.9108 | 12884843520 |             2097152 |                 256 |                  2 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |     128 | a100_80gb |
|  gpt13b |       8192 |  64xA100_80GB | 0.3351 | 0.4224 | 0.4468 | 0.5631 |         86550.86 |               1352.3571 |          10.5653 | 12884843520 |             1048576 |                 128 |                  2 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      64 | a100_80gb |
|  gpt13b |       8192 |  32xA100_80GB | 0.3382 | 0.4263 | 0.4510 | 0.5684 |         43682.94 |               1365.0918 |           5.3324 | 12884843520 |              524288 |                  64 |                  2 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      32 | a100_80gb |
|  gpt13b |       8192 |  16xA100_80GB | 0.3362 | 0.4238 | 0.4483 | 0.5650 |         21710.52 |               1356.9075 |           2.6502 | 12884843520 |              262144 |                  32 |                  2 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_80gb |
|  gpt13b |       4096 |  64xA100_80GB | 0.3906 | 0.4416 | 0.5208 | 0.5888 |        101058.89 |               1579.0451 |          24.6726 | 12863872000 |             1048576 |                 256 |                  4 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      64 | a100_80gb |
|  gpt13b |       4096 |  32xA100_80GB | 0.3878 | 0.4384 | 0.5171 | 0.5846 |         50169.12 |               1567.7850 |          12.2483 | 12863872000 |              524288 |                 128 |                  4 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      32 | a100_80gb |
|  gpt13b |       4096 |  16xA100_80GB | 0.3899 | 0.4408 | 0.5199 | 0.5877 |         25218.46 |               1576.1536 |           6.1569 | 12863872000 |              262144 |                  64 |                  4 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_80gb |
|  gpt13b |       2048 | 128xA100_80GB | 0.4226 | 0.4502 | 0.5635 | 0.6003 |        218852.00 |               1709.7813 |         106.8613 | 12853386240 |             2097152 |                1024 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |     128 | a100_80gb |
|  gpt13b |       2048 |  64xA100_80GB | 0.4251 | 0.4529 | 0.5668 | 0.6038 |        110076.33 |               1719.9427 |          53.7482 | 12853386240 |             1048576 |                 512 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      64 | a100_80gb |
|  gpt13b |       2048 |  32xA100_80GB | 0.4197 | 0.4471 | 0.5596 | 0.5961 |         54335.55 |               1697.9859 |          26.5310 | 12853386240 |              524288 |                 256 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      32 | a100_80gb |
|  gpt13b |       2048 |  16xA100_80GB | 0.4274 | 0.4553 | 0.5699 | 0.6071 |         27666.72 |               1729.1699 |          13.5091 | 12853386240 |              262144 |                 128 |                  8 |         1 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_80gb |
|  gpt13b |      16384 |   8xA100_80GB | 0.2691 | 0.4088 | 0.3588 | 0.5451 |          8659.76 |               1082.4704 |           0.5285 | 12926786560 |             4194304 |                 256 |                  1 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|  gpt13b |       8192 |   8xA100_80GB | 0.3424 | 0.4316 | 0.4566 | 0.5755 |         11055.68 |               1381.9597 |           1.3496 | 12884843520 |             4194304 |                 512 |                  2 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|  gpt13b |       4096 |   8xA100_80GB | 0.3974 | 0.4492 | 0.5298 | 0.5989 |         12850.50 |               1606.3130 |           3.1373 | 12863872000 |             4194304 |                1024 |                  4 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|  gpt13b |       2048 |   8xA100_80GB | 0.4304 | 0.4585 | 0.5738 | 0.6113 |         13929.35 |               1741.1686 |           6.8014 | 12853386240 |             4194304 |                2048 |                  8 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|  gpt13b |       1024 |   8xA100_80GB | 0.4514 | 0.4661 | 0.6019 | 0.6215 |         14615.32 |               1826.9146 |          14.2728 | 12848143360 |             4194304 |                4096 |                 16 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|  gpt13b |        512 |   8xA100_80GB | 0.4618 | 0.4693 | 0.6157 | 0.6257 |         14954.35 |               1869.2934 |          29.2077 | 12845521920 |             4194304 |                8192 |                 32 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|  gpt13b |        512 |   8xA100_80GB | 0.4632 | 0.4708 | 0.6176 | 0.6277 |         15001.49 |               1875.1866 |          29.2998 | 12845521920 |              524288 |                1024 |                 32 |         4 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt7b |      16384 |   8xA100_80GB | 0.2406 | 0.3945 | 0.3208 | 0.5260 |         14901.90 |               1862.7379 |           0.9095 |  6717124608 |             4194304 |                 256 |                  2 |        16 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt7b |       8192 |   8xA100_80GB | 0.3120 | 0.4123 | 0.4161 | 0.5497 |         19422.58 |               2427.8221 |           2.3709 |  6683570176 |             4194304 |                 512 |                  4 |        16 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt7b |       4096 |   8xA100_80GB | 0.3741 | 0.4344 | 0.4988 | 0.5791 |         23343.51 |               2917.9392 |           5.6991 |  6666792960 |             4194304 |                1024 |                  8 |        16 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt7b |       2048 |   8xA100_80GB | 0.4106 | 0.4437 | 0.5474 | 0.5916 |         25651.12 |               3206.3898 |          12.5250 |  6658404352 |             4194304 |                2048 |                 16 |        16 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt3b |      16384 |   8xA100_80GB | 0.1829 | 0.3654 | 0.2438 | 0.4872 |         28295.66 |               3536.9574 |           1.7270 |  2688253440 |             4194304 |                 256 |                  4 |         8 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt3b |       8192 |   8xA100_80GB | 0.2522 | 0.3792 | 0.3363 | 0.5056 |         39341.83 |               4917.7293 |           4.8025 |  2667281920 |             4194304 |                 512 |                  8 |         8 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt3b |       4096 |   8xA100_80GB | 0.3140 | 0.3933 | 0.4187 | 0.5245 |         49169.98 |               6146.2477 |          12.0044 |  2656796160 |             4194304 |                1024 |                 16 |         8 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt3b |       2048 |   8xA100_80GB | 0.3551 | 0.4000 | 0.4735 | 0.5334 |         55710.27 |               6963.7837 |          27.2023 |  2651553280 |             4194304 |                2048 |                 32 |         8 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt1b |      16384 |   8xA100_80GB | 0.1579 | 0.3471 | 0.2106 | 0.4627 |         48846.93 |               6105.8662 |           2.9814 |  1345083392 |             4194304 |                 256 |                  4 |         8 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt1b |       8192 |   8xA100_80GB | 0.2206 | 0.3544 | 0.2942 | 0.4725 |         69094.52 |               8636.8154 |           8.4344 |  1328306176 |             4194304 |                 512 |                  8 |         8 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt1b |       4096 |   8xA100_80GB | 0.2806 | 0.3662 | 0.3741 | 0.4882 |         88432.31 |              11054.0390 |          21.5899 |  1319917568 |             4194304 |                1024 |                 16 |         8 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
|   gpt1b |       2048 |   8xA100_80GB | 0.3187 | 0.3674 | 0.4249 | 0.4899 |        100751.50 |              12593.9379 |          49.1951 |  1315723264 |             4194304 |                2048 |                 32 |         8 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt760m |      16384 |   8xA100_80GB | 0.1741 | 0.4429 | 0.1741 | 0.4429 |         92578.78 |              11572.3469 |           5.6506 |   782320128 |             4194304 |                 256 |                  2 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt760m |       8192 |   8xA100_80GB | 0.2409 | 0.4300 | 0.2409 | 0.4300 |        130205.04 |              16275.6301 |          15.8942 |   769737216 |             4194304 |                 512 |                  4 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt760m |       4096 |   8xA100_80GB | 0.3045 | 0.4249 | 0.3045 | 0.4249 |        165901.89 |              20737.7357 |          40.5034 |   763445760 |             4194304 |                1024 |                  8 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt760m |       2048 |   8xA100_80GB | 0.3488 | 0.4180 | 0.3488 | 0.4180 |        190823.20 |              23852.8998 |          93.1754 |   760300032 |             4194304 |                2048 |                 16 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt350m |      16384 |   8xA100_80GB | 0.1465 | 0.4648 | 0.1465 | 0.4648 |        164446.54 |              20555.8170 |          10.0370 |   370551808 |             4194304 |                 256 |                  2 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt350m |       8192 |   8xA100_80GB | 0.2018 | 0.4262 | 0.2018 | 0.4262 |        231820.82 |              28977.6026 |          28.2984 |   362163200 |             4194304 |                 512 |                  4 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt350m |       4096 |   8xA100_80GB | 0.2497 | 0.3901 | 0.2497 | 0.3901 |        290135.04 |              36266.8800 |          70.8337 |   357968896 |             4194304 |                1024 |                  8 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt350m |       2048 |   8xA100_80GB | 0.2870 | 0.3682 | 0.2870 | 0.3682 |        335500.45 |              41937.5565 |         163.8186 |   355871744 |             4194304 |                2048 |                 16 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt125m |      16384 |   8xA100_80GB | 0.1266 | 0.4072 | 0.1266 | 0.4072 |        386517.07 |              48314.6342 |          23.5911 |   136236288 |             4194304 |                 256 |                  4 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt125m |       8192 |   8xA100_80GB | 0.1651 | 0.3568 | 0.1651 | 0.3568 |        528395.14 |              66049.3926 |          64.5014 |   129944832 |             4194304 |                 512 |                  8 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt125m |       4096 |   8xA100_80GB | 0.1983 | 0.3164 | 0.1983 | 0.3164 |        650554.90 |              81319.3626 |         158.8269 |   126799104 |             4194304 |                1024 |                 16 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt125m |       2048 |   8xA100_80GB | 0.2210 | 0.2877 | 0.2210 | 0.2877 |        734298.52 |              91787.3152 |         358.5442 |   125226240 |             4194304 |                2048 |                 32 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt125m |        512 |   8xA100_80GB | 0.2457 | 0.2644 | 0.2457 | 0.2644 |        823936.33 |             102992.0416 |        1609.2506 |   124046592 |             8388608 |               16384 |                128 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt125m |        512 |   8xA100_80GB | 0.2459 | 0.2646 | 0.2459 | 0.2646 |        824517.51 |             103064.6886 |        1610.3858 |   124046592 |             4194304 |                8192 |                128 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt125m |        512 |   8xA100_80GB | 0.2450 | 0.2637 | 0.2450 | 0.2637 |        821720.79 |             102715.0989 |        1604.9234 |   124046592 |             2097152 |                4096 |                128 |         4 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt125m |        512 |   8xA100_80GB | 0.2424 | 0.2609 | 0.2424 | 0.2609 |        813029.11 |             101628.6387 |        1587.9475 |   124046592 |             1048576 |                2048 |                128 |         2 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |
| gpt125m |        512 |   8xA100_80GB | 0.2405 | 0.2588 | 0.2405 | 0.2588 |        806639.74 |             100829.9674 |        1575.4682 |   124046592 |              524288 |                1024 |                128 |         1 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_80gb |

## A100 40GB

| Model   | SeqLen (T) | GPUType       | MFU*   | MFU    | HFU*   | HFU    | Throughput (T/s) | GPUThroughput (T/s/GPU) | Throughput (S/s) | ParamCount  | GlobalBatchSize (T) | GlobalBatchSize (S) | MicroBatchSize (S) | GradAccum | ShardStrategy | ActCkpt | ActCPUoffload | Precision | MP Mode | NumGPUs | GPUType   |
| ------- | ---------- | ------------- | ------ | ------ | ------ | ------ | ---------------- | ----------------------- | ---------------- | ----------- | ------------------- | ------------------- | ------------------ | --------- | ------------- | ------- | ------------- | --------- | ------- | ------- | --------- |
|  gpt13b |       2048 |   8xA100_40GB | 0.2003 | 0.2133 | 0.2670 | 0.2845 |          6481.74 |                810.2170 |           3.1649 | 12853386240 |             8388608 |                4096 |                  1 |       512 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt7b |      16384 |  16xA100_40GB | 0.2288 | 0.3750 | 0.3050 | 0.5001 |         28335.96 |               1770.9978 |           1.7295 |  6717124608 |             8388608 |                 512 |                  1 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
|   gpt7b |      16384 |   8xA100_40GB | 0.2133 | 0.3497 | 0.2844 | 0.4662 |         13209.76 |               1651.2205 |           0.8063 |  6717124608 |             8388608 |                 512 |                  1 |        64 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt7b |       8192 |  16xA100_40GB | 0.2798 | 0.3697 | 0.3730 | 0.4929 |         34828.29 |               2176.7680 |           4.2515 |  6683570176 |             8388608 |                1024 |                  1 |        64 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
|   gpt7b |       8192 |   8xA100_40GB | 0.2836 | 0.3748 | 0.3782 | 0.4997 |         17654.50 |               2206.8122 |           2.1551 |  6683570176 |             8388608 |                1024 |                  1 |       128 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt7b |       4096 |  16xA100_40GB | 0.3503 | 0.4068 | 0.4671 | 0.5423 |         43721.20 |               2732.5747 |          10.6741 |  6666792960 |             8388608 |                2048 |                  4 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
|   gpt7b |       4096 |   8xA100_40GB | 0.3321 | 0.3856 | 0.4428 | 0.5141 |         20723.96 |               2590.4947 |           5.0596 |  6666792960 |             8388608 |                2048 |                  2 |       128 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt7b |       2048 |  16xA100_40GB | 0.3839 | 0.4149 | 0.5119 | 0.5531 |         47970.51 |               2998.1568 |          23.4231 |  6658404352 |             8388608 |                4096 |                  8 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
|   gpt7b |       2048 |   8xA100_40GB | 0.3628 | 0.3921 | 0.4838 | 0.5228 |         22668.72 |               2833.5898 |          11.0687 |  6658404352 |             8388608 |                4096 |                  4 |       128 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt7b |       1024 |  16xA100_40GB | 0.4055 | 0.4219 | 0.5407 | 0.5625 |         50702.28 |               3168.8928 |          49.5140 |  6654210048 |             8388608 |                8192 |                 16 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
|   gpt7b |       1024 |   8xA100_40GB | 0.3760 | 0.3912 | 0.5014 | 0.5216 |         23507.13 |               2938.3910 |          22.9562 |  6654210048 |             8388608 |                8192 |                  8 |       128 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt7b |       1024 |   8xA100_40GB | 0.3782 | 0.3935 | 0.5043 | 0.5246 |         23644.47 |               2955.5584 |          23.0903 |  6654210048 |              524288 |                 512 |                  8 |         8 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt3b |      16384 |  16xA100_40GB | 0.1749 | 0.3496 | 0.2333 | 0.4662 |         54143.88 |               3383.9923 |           3.3047 |  2688253440 |             8388608 |                 512 |                  1 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
|   gpt3b |      16384 |   8xA100_40GB | 0.1754 | 0.3505 | 0.2338 | 0.4673 |         27136.33 |               3392.0410 |           1.6563 |  2688253440 |             8388608 |                 512 |                  1 |        64 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt3b |       8192 |  16xA100_40GB | 0.2353 | 0.3537 | 0.3137 | 0.4716 |         73389.42 |               4586.8390 |           8.9587 |  2667281920 |             8388608 |                1024 |                  2 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
|   gpt3b |       8192 |   8xA100_40GB | 0.2379 | 0.3576 | 0.3172 | 0.4768 |         37105.58 |               4638.1978 |           4.5295 |  2667281920 |             8388608 |                1024 |                  2 |        64 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt3b |       4096 |  16xA100_40GB | 0.2872 | 0.3598 | 0.3830 | 0.4797 |         89949.31 |               5621.8317 |          21.9603 |  2656796160 |             8388608 |                2048 |                  4 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
|   gpt3b |       4096 |   8xA100_40GB | 0.2925 | 0.3664 | 0.3901 | 0.4886 |         45806.55 |               5725.8189 |          11.1832 |  2656796160 |             8388608 |                2048 |                  4 |        64 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt3b |       2048 |  16xA100_40GB | 0.3241 | 0.3651 | 0.4321 | 0.4867 |        101680.35 |               6355.0221 |          49.6486 |  2651553280 |             8388608 |                4096 |                  8 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
|   gpt3b |       2048 |   8xA100_40GB | 0.3312 | 0.3731 | 0.4416 | 0.4975 |         51966.01 |               6495.7517 |          25.3740 |  2651553280 |             8388608 |                4096 |                  8 |        64 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt3b |       1024 |  16xA100_40GB | 0.3496 | 0.3717 | 0.4661 | 0.4956 |        109800.44 |               6862.5274 |         107.2270 |  2648931840 |             8388608 |                8192 |                 16 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
|   gpt3b |       1024 |   8xA100_40GB | 0.3595 | 0.3822 | 0.4793 | 0.5096 |         56451.90 |               7056.4877 |          55.1288 |  2648931840 |             8388608 |                8192 |                 16 |        64 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt3b |        512 |  16xA100_40GB | 0.3625 | 0.3740 | 0.4833 | 0.4986 |        113903.78 |               7118.9862 |         222.4683 |  2647621120 |             8388608 |               16384 |                 32 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
|   gpt3b |        512 |   8xA100_40GB | 0.3699 | 0.3817 | 0.4933 | 0.5089 |         58127.21 |               7265.9008 |         113.5297 |  2647621120 |             8388608 |               16384 |                 32 |        64 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt1b |      16384 |  16xA100_40GB | 0.1538 | 0.3379 | 0.2051 | 0.4506 |         95127.80 |               5945.4874 |           5.8061 |  1345083392 |             8388608 |                 512 |                  2 |        16 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
|   gpt1b |      16384 |   8xA100_40GB | 0.1551 | 0.3409 | 0.2069 | 0.4545 |         47981.69 |               5997.7114 |           2.9286 |  1345083392 |             8388608 |                 512 |                  2 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt1b |       8192 |  16xA100_40GB | 0.2117 | 0.3400 | 0.2822 | 0.4534 |        132589.32 |               8286.8326 |          16.1852 |  1328306176 |             8388608 |                1024 |                  4 |        16 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
|   gpt1b |       8192 |   8xA100_40GB | 0.2133 | 0.3426 | 0.2844 | 0.4568 |         66805.43 |               8350.6790 |           8.1550 |  1328306176 |             8388608 |                1024 |                  4 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt1b |       4096 |  16xA100_40GB | 0.2648 | 0.3456 | 0.3531 | 0.4608 |        166925.89 |              10432.8678 |          40.7534 |  1319917568 |             8388608 |                2048 |                  8 |        16 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
|   gpt1b |       4096 |   8xA100_40GB | 0.2684 | 0.3503 | 0.3579 | 0.4671 |         84606.61 |              10575.8259 |          20.6559 |  1319917568 |             8388608 |                2048 |                  8 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt1b |       2048 |  16xA100_40GB | 0.3047 | 0.3513 | 0.4063 | 0.4684 |        192671.44 |              12041.9648 |          94.0778 |  1315723264 |             8388608 |                4096 |                 16 |        16 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
|   gpt1b |       2048 |   8xA100_40GB | 0.3100 | 0.3574 | 0.4133 | 0.4766 |         98012.45 |              12251.5558 |          47.8576 |  1315723264 |             8388608 |                4096 |                 16 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt1b |       1024 |  16xA100_40GB | 0.3324 | 0.3578 | 0.4431 | 0.4771 |        210501.37 |              13156.3354 |         205.5677 |  1313626112 |             8388608 |                8192 |                 32 |        16 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
|   gpt1b |       1024 |   8xA100_40GB | 0.3380 | 0.3639 | 0.4506 | 0.4851 |        107026.65 |              13378.3309 |         104.5182 |  1313626112 |             8388608 |                8192 |                 32 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
|   gpt1b |        512 |  16xA100_40GB | 0.3464 | 0.3597 | 0.4618 | 0.4796 |        219562.21 |              13722.6381 |         428.8324 |  1312577536 |             8388608 |               16384 |                 64 |        16 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
|   gpt1b |        512 |   8xA100_40GB | 0.3538 | 0.3674 | 0.4718 | 0.4899 |        112139.27 |              14017.4086 |         219.0220 |  1312577536 |             8388608 |               16384 |                 64 |        32 |    FULL_SHARD |    True |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt760m |      16384 |  16xA100_40GB | 0.0958 | 0.2438 | 0.0958 | 0.2438 |        101922.24 |               6370.1402 |           6.2208 |   782320128 |             8388608 |                 512 |                  1 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt760m |      16384 |   8xA100_40GB | 0.1032 | 0.2627 | 0.1032 | 0.2627 |         54899.02 |               6862.3770 |           3.3508 |   782320128 |             8388608 |                 512 |                  1 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt760m |       8192 |  16xA100_40GB | 0.1310 | 0.2338 | 0.1310 | 0.2338 |        141596.26 |               8849.7664 |          17.2847 |   769737216 |             8388608 |                1024 |                  2 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt760m |       8192 |   8xA100_40GB | 0.1180 | 0.2106 | 0.1180 | 0.2106 |         63777.75 |               7972.2189 |           7.7854 |   769737216 |             8388608 |                1024 |                  2 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt760m |       4096 |  16xA100_40GB | 0.1127 | 0.1573 | 0.1127 | 0.1573 |        122858.95 |               7678.6842 |          29.9949 |   763445760 |             8388608 |                2048 |                  4 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt760m |       4096 |   8xA100_40GB | 0.1214 | 0.1694 | 0.1214 | 0.1694 |         66157.45 |               8269.6806 |          16.1517 |   763445760 |             8388608 |                2048 |                  4 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt760m |       2048 |  16xA100_40GB | 0.1244 | 0.1491 | 0.1244 | 0.1491 |        136160.26 |               8510.0160 |          66.4845 |   760300032 |             8388608 |                4096 |                  8 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt760m |       2048 |   8xA100_40GB | 0.1315 | 0.1576 | 0.1315 | 0.1576 |         71955.35 |               8994.4192 |          35.1345 |   760300032 |             8388608 |                4096 |                  8 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt760m |       1024 |  16xA100_40GB | 0.1196 | 0.1315 | 0.1196 | 0.1315 |        131139.70 |               8196.2310 |         128.0661 |   758727168 |             8388608 |                8192 |                 16 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt760m |       1024 |   8xA100_40GB | 0.1336 | 0.1469 | 0.1336 | 0.1469 |         73254.60 |               9156.8256 |          71.5377 |   758727168 |             8388608 |                8192 |                 16 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt760m |        512 |  16xA100_40GB | 0.1209 | 0.1270 | 0.1209 | 0.1270 |        132746.70 |               8296.6685 |         259.2709 |   757940736 |             8388608 |               16384 |                 32 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt760m |        512 |   8xA100_40GB | 0.1395 | 0.1465 | 0.1395 | 0.1465 |         76587.76 |               9573.4694 |         149.5855 |   757940736 |             8388608 |               16384 |                 32 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt350m |      16384 |  16xA100_40GB | 0.1397 | 0.4433 | 0.1397 | 0.4433 |        313675.94 |              19604.7462 |          19.1453 |   370551808 |             8388608 |                 512 |                  1 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt350m |      16384 |   8xA100_40GB | 0.1416 | 0.4493 | 0.1416 | 0.4493 |        158971.66 |              19871.4573 |           9.7029 |   370551808 |             8388608 |                 512 |                  1 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt350m |       8192 |  16xA100_40GB | 0.1865 | 0.3939 | 0.1865 | 0.3939 |        428526.96 |              26782.9350 |          52.3104 |   362163200 |             8388608 |                1024 |                  2 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt350m |       8192 |   8xA100_40GB | 0.1913 | 0.4039 | 0.1913 | 0.4039 |        219697.73 |              27462.2157 |          26.8186 |   362163200 |             8388608 |                1024 |                  2 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt350m |       4096 |  16xA100_40GB | 0.2192 | 0.3425 | 0.2192 | 0.3425 |        509534.70 |              31845.9187 |         124.3981 |   357968896 |             8388608 |                2048 |                  4 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt350m |       4096 |   8xA100_40GB | 0.2277 | 0.3558 | 0.2277 | 0.3558 |        264652.84 |              33081.6051 |          64.6125 |   357968896 |             8388608 |                2048 |                  4 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt350m |       2048 |  16xA100_40GB | 0.2538 | 0.3256 | 0.2538 | 0.3256 |        593324.81 |              37082.8006 |         289.7094 |   355871744 |             8388608 |                4096 |                  8 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt350m |       2048 |   8xA100_40GB | 0.2612 | 0.3351 | 0.2612 | 0.3351 |        305320.04 |              38165.0048 |         149.0821 |   355871744 |             8388608 |                4096 |                  8 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt350m |       1024 |  16xA100_40GB | 0.2722 | 0.3108 | 0.2722 | 0.3108 |        638263.34 |              39891.4586 |         623.3040 |   354823168 |             8388608 |                8192 |                 16 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt350m |       1024 |   8xA100_40GB | 0.2801 | 0.3199 | 0.2801 | 0.3199 |        328419.10 |              41052.3878 |         320.7218 |   354823168 |             8388608 |                8192 |                 16 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt350m |        512 |  16xA100_40GB | 0.2875 | 0.3079 | 0.2875 | 0.3079 |        675085.93 |              42192.8704 |        1318.5272 |   354298880 |             8388608 |               16384 |                 32 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt350m |        512 |   8xA100_40GB | 0.2974 | 0.3185 | 0.2974 | 0.3185 |        349208.73 |              43651.0912 |         682.0483 |   354298880 |             8388608 |               16384 |                 32 |        64 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt125m |      16384 |  32xA100_40GB | 0.1235 | 0.3973 | 0.1235 | 0.3973 |       1508631.35 |              47144.7296 |          92.0795 |   136236288 |             8388608 |                 512 |                  2 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      32 | a100_40gb |
| gpt125m |      16384 |   8xA100_40GB | 0.1251 | 0.4023 | 0.1251 | 0.4023 |        381870.41 |              47733.8010 |          23.3075 |   136236288 |             8388608 |                 512 |                  2 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt125m |       8192 |  32xA100_40GB | 0.1571 | 0.3396 | 0.1571 | 0.3396 |       2011647.84 |              62863.9949 |         245.5625 |   129944832 |             8388608 |                1024 |                  4 |         8 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      32 | a100_40gb |
| gpt125m |       8192 |   8xA100_40GB | 0.1591 | 0.3439 | 0.1591 | 0.3439 |        509301.39 |              63662.6739 |          62.1706 |   129944832 |             8388608 |                1024 |                  4 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt125m |       4096 |  16xA100_40GB | 0.1837 | 0.2931 | 0.1837 | 0.2931 |       1205308.62 |              75331.7888 |         294.2648 |   126799104 |             8388608 |                2048 |                  8 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt125m |       4096 |   8xA100_40GB | 0.1856 | 0.2961 | 0.1856 | 0.2961 |        608896.66 |              76112.0819 |         148.6564 |   126799104 |             8388608 |                2048 |                  8 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt125m |       2048 |  16xA100_40GB | 0.2000 | 0.2603 | 0.2000 | 0.2603 |       1328659.15 |              83041.1968 |         648.7594 |   125226240 |             8388608 |                4096 |                 16 |        16 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |      16 | a100_40gb |
| gpt125m |       2048 |   8xA100_40GB | 0.2034 | 0.2648 | 0.2034 | 0.2648 |        675801.76 |              84475.2205 |         329.9813 |   125226240 |             8388608 |                4096 |                 16 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt125m |       1024 |   8xA100_40GB | 0.2142 | 0.2467 | 0.2142 | 0.2467 |        716232.55 |              89529.0688 |         699.4458 |   124439808 |             8388608 |                8192 |                 32 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
| gpt125m |        512 |   8xA100_40GB | 0.2215 | 0.2383 | 0.2215 | 0.2383 |        742696.31 |              92837.0394 |        1450.5787 |   124046592 |             8388608 |               16384 |                 64 |        32 |    FULL_SHARD |   False |         False |  amp_bf16 | DEFAULT |       8 | a100_40gb |
